<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto;width:49.61em}</style></head><body><p>#　批量讀取文件　－Ｈｒ篩選簡歷 -利用關鍵字篩選簡歷</p><p># 自動生成word</p><p>import glob</p><p>final_result = []</p><p>def search(path, target):</p><p><span class="pydocx-tab"></span>res = glob.glob(path)</p><p><span class="pydocx-tab"></span>for i in res:</p><p><span style="margin-left:2.00em;text-indent:2.00em">if glob.os.isdir(i):</span></p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>_path = glob.os.path.join(i, ‘*’)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>search(_path, target)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>else:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>if target in i:  # 查文件名</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>final_result.append(i)</p><p><span class="pydocx-tab"></span>return final_result</p><p>if __name__ == “__main__”:</p><p><span class="pydocx-tab"></span>path = glob.os.path.join(glob.os.getcwd(), ‘*’)</p><p><span class="pydocx-tab"></span>search(path, target=’python’)</p><p>import glob</p><p>final_result = []</p><p>def search(path, target):</p><p><span class="pydocx-tab"></span>result = glob.glob(path)</p><p><span class="pydocx-tab"></span>for _data in result:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>if glob.os.path.isdir(_data):</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>_path = glob.os.path.join(glob.os.getcwd(), ‘*’)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>search(_path, target)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>else:<span class="pydocx-tab"></span></p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>f = open(_data, ‘r’, encoding=’utf-8)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>content = f.read()  </p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>if target in content:  # 查文件的內容</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>final_result.append(i)</p><p><span class="pydocx-tab"></span>return final_result</p><p>if __name__ == ‘__main__’:</p><p><span class="pydocx-tab"></span>path = glob.os.path.join(glob.os.getcwd(), ‘*’)</p><p><span class="pydocx-tab"></span>res = search(path, target=’lun’)</p><p><span class="pydocx-tab"></span>print(res)</p><p># coding:utf-8</p><p>#data = {'name': {'path/name': 'content', 'path2/name': 'content'}}</p><p># 但是name裡有zip要避開 –要獲取文件路徑最後的字符串</p><p>data = {}</p><p>def search(path):</p><p><span class="pydocx-tab"></span>res = glob.glob(path)</p><p><span class="pydocx-tab"></span>for _data in res:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>if glob.os.path.isdir(_data):</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>_path = glob.os.path.join(_data, ‘*’)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>search(_path, target)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>else:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>name = glob.os.path.split(_data)[-1]  # ‘.py’</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>if ‘zip in name:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>f = open(_data, ‘rb’)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>else:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>f = open(_data, ‘r’, encoding=’utf-8’)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>content = f.read()</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>f.close()</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span></p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>if name in data:  # 要確定文件名在字典內</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>sub_data = data[name]  # v -‘.py’的內容</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span></p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>for k, v in sub_data.items():</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>if v == content:  # 如果內容相同</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>glob.os.remove(_data)  # 直接移除整個路徑</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>print(f‘{_data} will be deleted.’)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>else:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>data[name][_data] = content  #　‘.py’的內容</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>else:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>sub_data/data[name] = {</p><p><span class="pydocx-tab"></span>_data: content</p><p>}</p><p>If __name__ == ‘__main__’:</p><p><span class="pydocx-tab"></span>path = glob.os.path.join(glob.os.getcwd(), ‘*’)</p><p><span class="pydocx-tab"></span>search(path)</p><p><span class="pydocx-tab"></span>for k, v in data.items():  # 整個字典</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>print(k, v)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>for k, v in v.items():  # 第二層字典</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>print(k, v)</p><p># update_name – </p><p>文件複製, 內容覆蓋, 裁減(移動, 重命名), 刪除 ?, 壓縮, 解壓縮</p><ul><li>都必須先獲取origin, target的絕對路徑 -? </li><li>-&gt; os.path.join(os.getcwd(), ‘file_name’))</li><li>可用shutil庫 -複製, 內容覆蓋, 裁減(移動, 重命名), 壓縮, 解壓縮</li></ul><p>Copy -from shutil import copy(orgin, target) -target:file, filefolder</p><p>Cover-from shutil import copyfile(origin, target) -target: file</p><p>Move -from shutil import move(origin, target) -target: file, filefoler, 可以不存在</p><ul><li>move -裁減文件進文件夾;  rename: target存在, 相當於起新名</li></ul><p>make_archive -from shutil import make_archive(new_name, 後綴, origin) -return 生成的壓縮包地址</p><p>unpack_archive- from shutil import unpack_archive(target, 解壓後的路徑) </p><ul><li>刪除 – from os import remove -remove(origin, target)</li></ul><p>import glob</p><p>文件夾複製, 裁減, 刪除</p><p>Copy – from shutil import copytree(origin, target) -FileExistError: target不能存在</p><p>Cut – from shutil import move(origin, target) -當target不存在, 屬於重命名</p><p>Remove -from shutil import rmtree(origin, target) -FileNotFoundError: target要存在</p><p>def update_name(path):</p><p><span class="pydocx-tab"></span>res = glob.glob(path)</p><p><span class="pydocx-tab"></span>for _data in res:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>if glob.os.path.isdir(_data):</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>_path = glob.os.path.join(_data, ‘*’)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>update_name(_path)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>else:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>_path_list = glob.os.path.split(_data)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>Name = _path_list[-1]</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>new_name = ‘imooc_%s’ % (len(name)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>new_path = glob.os.path.join(_path_list[0], new_name)</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>shutil.move(_data, new_path)</p><p>if __name__ == ‘__main__’:</p><p><span class="pydocx-tab"></span>path = glob.os.path.join(glob.os.getcwd(), ‘*’)</p><p><span class="pydocx-tab"></span>update_name(path)<span class="pydocx-tab"></span></p><p>文件生成:</p><p>from docx import Document</p><p>都要先建立一個Document_obj</p><p>doc = Document()</p><p>保存資料: doc.save(‘filename.docx’)</p><p>全局樣式:  style = doc.styles[‘..’] - style樣式對象</p><p>斜體: style.italic = True, 粗體 style.bold = True, 顏色: style.font.color.rgb=RGBColor(), </p><p>大小 from docx.shared import Pt -style.font.size = Pt(20) </p><p>-&gt; 對追加的內容才有樣式</p><p>標題:h = doc.add_heading(‘..’, level) 增加: h.add_run(‘…’) </p><p>段落: p = doc.add_paragraph(‘..’) p.add_run()</p><p><span class="pydocx-tab"></span>置左, 中, 右: from docx.enum.text import WD_PARAGRAPH_ALIGNMENT.LEFT/CENTER/RIGHT</p><p>圖片: picture = doc.add_picture(origin, width=Inches(), height=Inches())</p><p><span class="pydocx-tab"></span>from docx.shared import Inches</p><p><span class="pydocx-tab"></span>置左, 中, 右: from docx.enum.text import <span class="pydocx-tab"></span>WD_ALIGN_PARAGRAPH. LEFT/CENTER/RIGHT</p><p><span class="pydocx-tab"></span>增加: picture.add_run(origin)</p><p>表格: table = doc.add_table(rows列=, cols行=, style=)</p><p><span class="pydocx-tab"></span>cell = table.rows[0].cells -表格列對象</p><p><span class="pydocx-tab"></span>cell[0].text = 當前列0行的內容</p><p><span class="pydocx-tab"></span>cell[1].text = 當前列1行的內容</p><p><span class="pydocx-tab"></span>表格樣式: from docx.enum.text import WD_STYLE_TYPE</p><p>分頁: doc.add_page_break()</p><p>ReadExcel  WriteExcel</p><p>import xlrd</p><p>import xlsxwriter</p><p>def read():</p><p><span class="pydocx-tab"></span>excel = xlrd.open_workbook(‘Excel_name’)  # read excel_obj</p><p><span class="pydocx-tab"></span>booksheet = excel.sheet_by_name(‘sheet_name’)  # read worksheet</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>  excel.sheet_by_index()</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>  excel.sheets()  -gross sheets</p><p><span class="pydocx-tab"></span>booksheet.nrows()</p><p><span class="pydocx-tab"></span>booksheet.ncols()</p><p><span class="pydocx-tab"></span>for i in booksheet.get_rows():</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>i == [text:'姓名', text:'性别', text:'年龄', text:'成绩', text:'等级']</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>content = []</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>for j in i:</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>j == text:'姓名', text:'性别', text:'年龄', text:'成绩', text:'等级'</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>content.append(j.value)</p><p><span class="pydocx-tab"></span>print(content)</p><p>    ['姓名', '性别', '年龄', '成绩', '等级']</p><p><span style="text-indent:2.00em">['小慕', '男', 10.0, 90.0, '优']</span></p><p>def write():</p><p><span class="pydocx-tab"></span>excel = xlsxwriter.Workbook(‘Excel_name’)</p><p><span class="pydocx-tab"></span>worksheet = excel.add_sheet(‘sheet_name’)</p><p><span class="pydocx-tab"></span>for row, data in enumerate(content):</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span>for cols, v in enumerate(data):</p><p><span class="pydocx-tab"></span><span class="pydocx-tab"></span><span class="pydocx-tab"></span>worksheet.wirte(row, cols, v)</p><p># 重頭寫一個新的工作簿</p><p>book1 = excel.add_sheet(‘new_sheet_name’)</p><p>data = [</p><p><span class="pydocx-tab"></span>(‘excellent’, ‘good’, ‘soso’, ‘bad’),</p><p><span class="pydocx-tab"></span>(10, 7, 5, 3) </p><p>]</p><p>book1.write_column(‘A1’, data[0])</p><p>book1.write_column(‘B1’, data[1])</p><p># 圖表製作</p><p>chart = book1.add_chart(‘type’: ‘pie’) # pie圖</p><p># 數據 -title, data, name</p><p>chart.add_series(</p><p><span class="pydocx-tab"></span>categories: new_sheet_name!$A$1:$A$4,</p><p><span class="pydocx-tab"></span>values: new_sheet_name!$B$1: $B$4,</p><p><span class="pydocx-tab"></span>name: pie_chart  # 定義數據名稱</p><p>)</p><p>chart.set_title(‘pie_title’)  # 定義圖表名稱</p><p>excel.close() # 保存資料</p><p>if __name__ == ‘__main__’:</p><p><span class="pydocx-tab"></span>result = read()</p><p><span class="pydocx-tab"></span>print(result)</p><p><span class="pydocx-tab"></span>write()</p><p># word -&gt; html -&gt; pdf</p><p>import pdfkit – pip install htmltopdf</p><p># html -&gt; pdf :  pdfkit.from_file(html, save_pdf_path)</p><p># str -&gt; html: pdfkit.from_string(html based str, save_pdf_path)</p><p># url -&gt; pdf: pdfkit.from_url(url, save_pdf_path)</p><p># word -&gt; html : pydocx</p><p>from pydocx import PyDocX – pip install pydocx</p><p>html = PyDocx.to_html(word.docx)</p><p>f = open(html, ‘w’)</p><p>f.write(html)</p><p>f.close()</p><p>## html -&gt; pdf: pdfkit – pip install htmltopdf</p><p>pdfkit.from_string(html, save_path_pdf)</p><p># Reminder -需要手動給予htmltopdf的絕對路徑加入到本地文件中: </p><p>path_wk = r’ C:\Users\user\Desktop\wkhtmltox\bin\wkhtmltopdf.exe'</p><p>config = pdfkit.configuration = (wkhtmltopdf = path_wk)</p><p>configuration = config</p></body></html>